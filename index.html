<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ê°ì •ì¹´ë“œ í¬ë¦¬ì—ì´í„° - ë‚˜ë§Œì˜ ê°ì •ì„ ê·¸ë¦¼ìœ¼ë¡œ í‘œí˜„í•˜ì„¸ìš”">
    <meta name="theme-color" content="#8b5cf6">
    <title>ê°ì •ì¹´ë“œ í¬ë¦¬ì—ì´í„° - ê³µìš© ë””ë°”ì´ìŠ¤ ë²„ì „</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        * {
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Noto Sans KR', sans-serif;
            overflow-x: hidden;
        }
        
        .emotion-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .emotion-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .emotion-card.selected {
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
            color: white;
        }
        
        .canvas-container {
            touch-action: none;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }
        
        .color-btn {
            transition: all 0.2s ease;
        }
        
        .color-btn.active {
            transform: scale(1.2);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.3);
        }
        
        .tab-btn {
            transition: all 0.3s ease;
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .category-btn {
            transition: all 0.2s ease;
        }
        
        .category-btn.active {
            background: linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%);
            color: white;
        }
        
        .gallery-card {
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tag-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            margin: 0.125rem;
        }
        
        @media print {
            .no-print {
                display: none !important;
            }
            
            .print-only {
                display: block !important;
            }
            
            body {
                background: white !important;
            }
        }
        
        .print-only {
            display: none;
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ë§ */
        .emotion-scroll::-webkit-scrollbar {
            width: 6px;
        }
        
        .emotion-scroll::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        .emotion-scroll::-webkit-scrollbar-thumb {
            background: #8b5cf6;
            border-radius: 10px;
        }
        
        .emotion-scroll::-webkit-scrollbar-thumb:hover {
            background: #7c3aed;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-pink-50 min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- í—¤ë” -->
        <div class="bg-white rounded-2xl shadow-xl p-6 mb-8">
            <div>
                <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent">
                    ğŸ¨ ê°ì •ì¹´ë“œ í¬ë¦¬ì—ì´í„°
                </h1>
                <p class="text-gray-600 mt-2">ë‚˜ë§Œì˜ ê°ì •ì„ ê·¸ë¦¼ìœ¼ë¡œ í‘œí˜„í•˜ê³  ì €ì¥í•´ë³´ì„¸ìš”!</p>
                <p class="text-sm text-orange-600 mt-1">âš ï¸ ê³µìš© ë””ë°”ì´ìŠ¤: ì‘ì—… ì™„ë£Œ í›„ ë°˜ë“œì‹œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”. ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìœ¼ë©´ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.</p>
            </div>
        </div>

        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="flex flex-wrap justify-center gap-2 mb-8 no-print">
            <button onclick="switchTab(event, 'create')" class="tab-btn active px-4 py-2 md:px-6 md:py-3 rounded-full bg-white shadow-lg font-medium text-sm md:text-base">
                ğŸ¨ ì¹´ë“œ ë§Œë“¤ê¸°
            </button>
            <button onclick="switchTab(event, 'gallery')" class="tab-btn px-4 py-2 md:px-6 md:py-3 rounded-full bg-white shadow-lg font-medium text-sm md:text-base">
                ğŸ–¼ï¸ ì˜¤ëŠ˜ì˜ ì‘í’ˆ
            </button>
            <button onclick="switchTab(event, 'dictionary')" class="tab-btn px-4 py-2 md:px-6 md:py-3 rounded-full bg-white shadow-lg font-medium text-sm md:text-base">
                ğŸ“š ê°ì • ì‚¬ì „
            </button>
            <button onclick="switchTab(event, 'help')" class="tab-btn px-4 py-2 md:px-6 md:py-3 rounded-full bg-white shadow-lg font-medium text-sm md:text-base">
                â“ ì‚¬ìš©ë²•
            </button>
        </div>

        <!-- ì¹´ë“œ ë§Œë“¤ê¸° íƒ­ -->
        <div id="create-tab" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- ì™¼ìª½: ê·¸ë¦¬ê¸° ì˜ì—­ -->
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                    <h2 class="text-xl md:text-2xl font-bold mb-4 text-gray-800">ğŸ¨ ê·¸ë¦¼ ê·¸ë¦¬ê¸°</h2>
                    
                    <!-- ë„êµ¬ ë²„íŠ¼ë“¤ -->
                    <div class="flex flex-wrap gap-2 md:gap-3 mb-4">
                        <button onclick="setTool(event, 'pen')" class="tool-btn px-3 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition text-sm md:text-base">
                            âœï¸ íœ
                        </button>
                        <button onclick="setTool(event, 'eraser')" class="tool-btn px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition text-sm md:text-base">
                            ğŸ§¹ ì§€ìš°ê°œ
                        </button>
                        <button onclick="document.getElementById('imageUpload').click()" class="px-3 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition text-sm md:text-base">
                            ğŸ“· ì‚¬ì§„
                        </button>
                        <button onclick="clearCanvas()" class="px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition text-sm md:text-base">
                            ğŸ—‘ï¸ ì „ì²´ì‚­ì œ
                        </button>
                        <button onclick="undo()" class="px-3 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition text-sm md:text-base">
                            â†©ï¸ ë˜ëŒë¦¬ê¸°
                        </button>
                    </div>
                    <input type="file" id="imageUpload" accept="image/*" class="hidden" onchange="handleImageUpload(event)">

                    <!-- ìƒ‰ìƒ íŒ”ë ˆíŠ¸ -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ìƒ‰ìƒ ì„ íƒ:</label>
                        <div class="flex flex-wrap gap-2" id="color-palette">
                            <!-- ìƒ‰ìƒ ë²„íŠ¼ë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- íœ êµµê¸° -->
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">êµµê¸°:</label>
                        <div class="flex items-center gap-2">
                            <input type="range" id="pen-size" min="1" max="20" value="5" class="flex-1">
                            <span id="size-value" class="text-sm font-bold">5</span>
                        </div>
                    </div>

                    <!-- ìº”ë²„ìŠ¤ -->
                    <div class="canvas-container bg-white border-4 border-gray-200 rounded-xl overflow-hidden">
                        <canvas id="drawingCanvas" width="600" height="400" class="w-full cursor-crosshair"></canvas>
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½: ê°ì • ì„ íƒ ë° ì„¤ì • -->
                <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                    <!-- ê°ì • ì„ íƒ -->
                    <div class="mb-6">
                        <h2 class="text-xl md:text-2xl font-bold mb-4 text-gray-800">1ï¸âƒ£ ê°ì • ì„ íƒí•˜ê¸°</h2>
                        
                        <!-- ê°ì • ê²€ìƒ‰ -->
                        <div class="mb-3">
                            <input type="text" id="emotion-search" placeholder="ğŸ” ê°ì • ê²€ìƒ‰ (ì˜ˆ: ê¸°ì¨, ìŠ¬í””)" 
                                class="w-full p-2 border rounded-lg text-sm" onkeyup="searchEmotions()">
                        </div>
                        
                        <!-- ì¹´í…Œê³ ë¦¬ íƒ­ -->
                        <div class="flex flex-wrap gap-1 mb-3">
                            <button onclick="filterCategory('all')" class="category-btn active px-2 py-1 bg-gray-100 rounded text-xs font-medium">ì „ì²´</button>
                            <button onclick="filterCategory('ê¸°ì¨')" class="category-btn px-2 py-1 bg-gray-100 rounded text-xs font-medium">ğŸ˜Š ê¸°ì¨</button>
                            <button onclick="filterCategory('ìŠ¬í””')" class="category-btn px-2 py-1 bg-gray-100 rounded text-xs font-medium">ğŸ˜¢ ìŠ¬í””</button>
                            <button onclick="filterCategory('í™”ë‚¨')" class="category-btn px-2 py-1 bg-gray-100 rounded text-xs font-medium">ğŸ˜¡ í™”ë‚¨</button>
                            <button onclick="filterCategory('ë¶ˆì•ˆ')" class="category-btn px-2 py-1 bg-gray-100 rounded text-xs font-medium">ğŸ˜° ë¶ˆì•ˆ</button>
                            <button onclick="filterCategory('ë†€ëŒ')" class="category-btn px-2 py-1 bg-gray-100 rounded text-xs font-medium">ğŸ˜² ë†€ëŒ</button>
                            <button onclick="filterCategory('ê¸°íƒ€')" class="category-btn px-2 py-1 bg-gray-100 rounded text-xs font-medium">ğŸ’­ ê¸°íƒ€</button>
                        </div>
                        
                        <!-- ê°ì • ëª©ë¡ -->
                        <div class="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-2 max-h-96 overflow-y-auto p-2 border rounded-lg emotion-scroll" id="emotion-selector">
                            <!-- ê°ì • ë²„íŠ¼ë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                        </div>
                    </div>

                    <!-- ì„ íƒëœ ê°ì • í‘œì‹œ -->
                    <div id="selected-emotion-display" class="hidden mb-6 p-4 bg-gradient-to-r from-purple-100 to-pink-100 rounded-xl">
                        <p class="text-lg font-medium">ì„ íƒí•œ ê°ì •: 
                            <span id="selected-emotion-text" class="text-xl md:text-2xl font-bold text-purple-600"></span>
                        </p>
                        <p id="selected-emotion-desc" class="text-gray-600 mt-1 text-sm"></p>
                        
                        <!-- ê°ì • ê°•ë„ -->
                        <div class="mt-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">ê°ì •ì˜ ê°•ë„</label>
                            <div class="flex items-center gap-4">
                                <span class="text-sm">ì•½í•¨</span>
                                <input type="range" id="emotion-intensity" min="1" max="10" value="5" class="flex-1">
                                <span class="text-sm">ê°•í•¨</span>
                                <span id="intensity-value" class="text-lg font-bold text-purple-600">5</span>
                            </div>
                        </div>
                    </div>

                    <!-- ìƒí™© ê¸°ë¡ -->
                    <div class="mb-6">
                        <h2 class="text-lg font-bold mb-2 text-gray-800">2ï¸âƒ£ ì–¸ì œ ì´ëŸ° ê°ì •ì„? (ì„ íƒ)</h2>
                        
                        <!-- ì‹œê°„ëŒ€ -->
                        <div class="mb-3">
                            <label class="block text-sm font-medium text-gray-700 mb-1">â° ì–¸ì œ</label>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="toggleTag(event, 'time', 'ì•„ì¹¨')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">ğŸŒ… ì•„ì¹¨</button>
                                <button onclick="toggleTag(event, 'time', 'ì ì‹¬')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">â˜€ï¸ ì ì‹¬</button>
                                <button onclick="toggleTag(event, 'time', 'ì €ë…')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">ğŸŒ† ì €ë…</button>
                                <button onclick="toggleTag(event, 'time', 'ë°¤')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">ğŸŒ™ ë°¤</button>
                            </div>
                        </div>
                        
                        <!-- ì¥ì†Œ -->
                        <div class="mb-3">
                            <label class="block text-sm font-medium text-gray-700 mb-1">ğŸ“ ì–´ë””ì„œ</label>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="toggleTag(event, 'place', 'ì§‘')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">ğŸ  ì§‘</button>
                                <button onclick="toggleTag(event, 'place', 'í•™êµ')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">ğŸ« í•™êµ</button>
                                <button onclick="toggleTag(event, 'place', 'ë°–')" class="tag-btn px-3 py-1 bg-gray-100 rounded-lg hover:bg-purple-100 text-sm">ğŸŒ³ ë°–</button>
                            </div>
                        </div>
                        
                        <!-- ìƒí™© ì„¤ëª… -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">âœï¸ ë©”ëª¨</label>
                            <input type="text" id="situation-desc" class="w-full p-2 border rounded-lg text-sm" 
                                placeholder="ì˜ˆ: ì¹œêµ¬ì™€ ë†€ ë•Œ">
                        </div>
                    </div>

                    <!-- í•™ìƒ ì •ë³´ -->
                    <div class="mb-6">
                        <h2 class="text-lg font-bold mb-2 text-gray-800">3ï¸âƒ£ ë§Œë“  ì‚¬ëŒ (ì„ íƒ)</h2>
                        <div class="grid grid-cols-2 gap-3">
                            <input type="text" id="student-name" placeholder="ì´ë¦„" class="p-2 border rounded-lg text-sm">
                            <input type="text" id="student-class" placeholder="í•™ë…„/ë°˜" class="p-2 border rounded-lg text-sm">
                        </div>
                    </div>

                    <!-- ì €ì¥ ë²„íŠ¼ë“¤ -->
                    <div class="flex flex-wrap gap-3">
                        <button onclick="saveToGallery()" class="px-4 py-2 bg-purple-500 text-white rounded-lg font-bold hover:bg-purple-600 transition">
                            ğŸ’¾ ê°¤ëŸ¬ë¦¬ì— ì¶”ê°€
                        </button>
                        <button onclick="downloadAsImage()" class="px-4 py-2 bg-green-500 text-white rounded-lg font-bold hover:bg-green-600 transition">
                            ğŸ–¼ï¸ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
                        </button>
                        <button onclick="downloadAsPDF()" class="px-4 py-2 bg-blue-500 text-white rounded-lg font-bold hover:bg-blue-600 transition">
                            ğŸ“„ PDF ë‹¤ìš´ë¡œë“œ
                        </button>
                        <button onclick="printCard()" class="px-4 py-2 bg-gray-500 text-white rounded-lg font-bold hover:bg-gray-600 transition">
                            ğŸ–¨ï¸ ì¸ì‡„
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ê°¤ëŸ¬ë¦¬ íƒ­ -->
        <div id="gallery-tab" class="tab-content hidden">
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                <div class="flex justify-between items-center mb-6">
                    <div>
                        <h2 class="text-xl md:text-2xl font-bold text-gray-800">ğŸ–¼ï¸ ì˜¤ëŠ˜ì˜ ì‘í’ˆë“¤</h2>
                        <p class="text-sm text-gray-500 mt-1">ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìœ¼ë©´ ì‚­ì œë©ë‹ˆë‹¤. ê¼­ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”!</p>
                    </div>
                    <button onclick="downloadAllAsPDF()" class="px-4 py-2 bg-purple-500 text-white rounded-lg font-medium hover:bg-purple-600 transition">
                        ğŸ“‘ ì „ì²´ PDF ë‹¤ìš´ë¡œë“œ
                    </button>
                </div>
                <div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                    <!-- ì €ì¥ëœ ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
                <div id="empty-gallery" class="text-center py-12 text-gray-400">
                    <p class="text-xl">ì•„ì§ ë§Œë“  ì¹´ë“œê°€ ì—†ì–´ìš”!</p>
                    <p class="mt-2">ì¹´ë“œ ë§Œë“¤ê¸° íƒ­ì—ì„œ ê°ì •ì¹´ë“œë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš” ğŸ¨</p>
                </div>
            </div>
        </div>

        <!-- ê°ì • ì‚¬ì „ íƒ­ -->
        <div id="dictionary-tab" class="tab-content hidden">
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                <h2 class="text-xl md:text-2xl font-bold mb-2 text-gray-800">ğŸ“š ê°ì • ì‚¬ì „</h2>
                <p class="text-gray-600 mb-6">64ê°€ì§€ ë‹¤ì–‘í•œ ê°ì •ì„ ì•Œì•„ë³´ê³ , ë‚˜ì˜ ê°ì •ì„ ì •í™•íˆ í‘œí˜„í•´ë³´ì„¸ìš”!</p>
                
                <!-- ê°ì • ì¹´í…Œê³ ë¦¬ ì„ íƒ íƒ­ -->
                <div class="flex flex-wrap gap-2 mb-6">
                    <button onclick="filterDictionaryCategory('all')" class="dict-category-btn active px-3 py-2 bg-purple-500 text-white rounded-lg text-sm font-medium">ì „ì²´ ë³´ê¸°</button>
                    <button onclick="filterDictionaryCategory('ê¸°ì¨')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ˜Š ê¸°ì¨</button>
                    <button onclick="filterDictionaryCategory('ìŠ¬í””')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ˜¢ ìŠ¬í””</button>
                    <button onclick="filterDictionaryCategory('í™”ë‚¨')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ˜¡ í™”ë‚¨</button>
                    <button onclick="filterDictionaryCategory('ë¶ˆì•ˆ')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ˜° ë¶ˆì•ˆ</button>
                    <button onclick="filterDictionaryCategory('ë†€ëŒ')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ˜² ë†€ëŒ</button>
                    <button onclick="filterDictionaryCategory('ë¶€ë„ëŸ¬ì›€')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ˜³ ë¶€ë„ëŸ¬ì›€</button>
                    <button onclick="filterDictionaryCategory('ê°ì‚¬')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ™ ê°ì‚¬</button>
                    <button onclick="filterDictionaryCategory('ê¸°íƒ€')" class="dict-category-btn px-3 py-2 bg-gray-100 rounded-lg text-sm font-medium hover:bg-purple-100">ğŸ’­ ê¸°íƒ€</button>
                </div>
                
                <!-- ê°ì • ì¹´í…Œê³ ë¦¬ë³„ ì„¹ì…˜ -->
                <div id="emotion-dictionary" class="max-h-[600px] overflow-y-auto emotion-scroll">
                    <!-- ê°ì • ì¹´ë“œë“¤ì´ JavaScriptë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>

        <!-- ì‚¬ìš©ë²• íƒ­ -->
        <div id="help-tab" class="tab-content hidden">
            <div class="bg-white rounded-2xl shadow-xl p-6 md:p-8">
                <h2 class="text-xl md:text-2xl font-bold mb-6 text-gray-800">â“ ì‚¬ìš©ë²•</h2>
                
                <div class="space-y-6">
                    <!-- ê¸°ë³¸ ì‚¬ìš©ë²• -->
                    <div class="bg-purple-50 rounded-lg p-4">
                        <h3 class="text-lg font-bold mb-3 text-purple-800">ğŸ“ ê¸°ë³¸ ì‚¬ìš©ë²•</h3>
                        <ol class="list-decimal list-inside space-y-2 text-gray-700">
                            <li><strong>ê°ì • ì„ íƒ:</strong> 64ê°€ì§€ ê°ì • ì¤‘ì—ì„œ í˜„ì¬ ëŠë¼ëŠ” ê°ì •ì„ ì„ íƒí•©ë‹ˆë‹¤. ê²€ìƒ‰í•˜ê±°ë‚˜ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.</li>
                            <li><strong>ê·¸ë¦¼ ê·¸ë¦¬ê¸°:</strong> ì™¼ìª½ ìº”ë²„ìŠ¤ì— ê°ì •ì„ í‘œí˜„í•˜ëŠ” ê·¸ë¦¼ì„ ê·¸ë¦½ë‹ˆë‹¤.</li>
                            <li><strong>ìƒí™© ê¸°ë¡:</strong> ì–¸ì œ, ì–´ë””ì„œ ì´ëŸ° ê°ì •ì„ ëŠê¼ˆëŠ”ì§€ ì„ íƒí•©ë‹ˆë‹¤.</li>
                            <li><strong>ì €ì¥/ë‹¤ìš´ë¡œë“œ:</strong> ì™„ì„±ëœ ì¹´ë“œë¥¼ ì´ë¯¸ì§€ë‚˜ PDFë¡œ ì €ì¥í•©ë‹ˆë‹¤.</li>
                        </ol>
                    </div>

                    <!-- ì£¼ì˜ì‚¬í•­ -->
                    <div class="bg-red-50 rounded-lg p-4">
                        <h3 class="text-lg font-bold mb-3 text-red-800">âš ï¸ ì£¼ì˜ì‚¬í•­</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>ğŸš¨ <strong>ê³µìš© ë””ë°”ì´ìŠ¤ì…ë‹ˆë‹¤!</strong> ê°œì¸ì •ë³´ë¥¼ ì…ë ¥í•˜ì§€ ë§ˆì„¸ìš”.</li>
                            <li>ğŸ’¾ ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìœ¼ë©´ ëª¨ë“  ì‘í’ˆì´ ì‚­ì œë©ë‹ˆë‹¤.</li>
                            <li>â¬‡ï¸ ì‘ì—… ì™„ë£Œ í›„ ë°˜ë“œì‹œ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.</li>
                            <li>ğŸ”„ ë‹¤ìŒ ì‚¬ìš©ìë¥¼ ìœ„í•´ ì‘ì—… í›„ ìƒˆë¡œê³ ì¹¨ì„ ê¶Œì¥í•©ë‹ˆë‹¤.</li>
                        </ul>
                    </div>
                    
                    <!-- ìƒˆë¡œìš´ ê¸°ëŠ¥ ì•ˆë‚´ -->
                    <div class="bg-green-50 rounded-lg p-4">
                        <h3 class="text-lg font-bold mb-3 text-green-800">âœ¨ íŠ¹ë³„í•œ ê¸°ëŠ¥</h3>
                        <ul class="space-y-2 text-gray-700">
                            <li>ğŸ“š <strong>64ê°€ì§€ ê°ì •:</strong> ë” ë‹¤ì–‘í•˜ê³  ì •í™•í•œ ê°ì • í‘œí˜„ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</li>
                            <li>ğŸ” <strong>ê°ì • ê²€ìƒ‰:</strong> ì›í•˜ëŠ” ê°ì •ì„ ë¹ ë¥´ê²Œ ì°¾ì„ ìˆ˜ ìˆì–´ìš”.</li>
                            <li>ğŸ“‚ <strong>ì¹´í…Œê³ ë¦¬ë³„ ì •ë ¬:</strong> ê¸°ì¨, ìŠ¬í””, í™”ë‚¨ ë“± ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê°ì •ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                            <li>ğŸ“– <strong>ê°ì • ì‚¬ì „:</strong> ëª¨ë“  ê°ì •ì˜ ì˜ë¯¸ë¥¼ ìì„¸íˆ ì•Œì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 64ê°€ì§€ ê°ì • ë°ì´í„° ì§ì ‘ ì •ì˜
        const emotions = [
            // ê¸°ì¨ ê´€ë ¨ (14ê°œ)
            { name: 'ê¸°ì˜ë‹¤', emoji: 'ğŸ˜Š', desc: 'ë°”ë¼ëŠ” ì¼ì´ ì´ë£¨ì–´ì ¸ ê¸°ë¶„ì´ ì¢‹ê³  ì¦ê²ë‹¤', color: '#FFEB3B', category: 'ê¸°ì¨' },
            { name: 'í–‰ë³µí•˜ë‹¤', emoji: 'ğŸ¥°', desc: 'ì¶©ë¶„íˆ ê¸°ì˜ê³  ë§Œì¡±ì„ ëŠë¼ë‹¤', color: '#FFE082', category: 'ê¸°ì¨' },
            { name: 'ê°ê²©ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ¥¹', desc: 'ë¿Œë“¯í•˜ê±°ë‚˜ ê¸°ë»ì„œ ê°€ìŠ´ì´ ë­‰í´í•´ì§€ë‹¤', color: '#FFCA28', category: 'ê¸°ì¨' },
            { name: 'ì„¤ë ˆë‹¤', emoji: 'ğŸ’—', desc: 'ë§ˆìŒì´ ë“¤ë– ì„œ ë‘ê·¼ê±°ë¦¬ë‹¤', color: '#FFB6C1', category: 'ê¸°ì¨' },
            { name: 'ì‹ ë‚˜ë‹¤', emoji: 'ğŸ¤—', desc: 'ì¬ë¯¸ìˆê³  ì¦ê±°ì›Œì„œ ê¸°ë¶„ì´ ì¢‹ë‹¤', color: '#FFF176', category: 'ê¸°ì¨' },
            { name: 'ë¿Œë“¯í•˜ë‹¤', emoji: 'ğŸ˜Œ', desc: 'ê¸°ì˜ê³  íë­‡í•œ ëŠë‚Œìœ¼ë¡œ ê°€ë“í•˜ë‹¤', color: '#FFE57F', category: 'ê¸°ì¨' },
            { name: 'ë²…ì°¨ë‹¤', emoji: 'ğŸ¥º', desc: 'ê¸°ì¨ì´ë‚˜ í¬ë§ì´ ë„˜ì¹  ë“¯ì´ ê°€ë“í•˜ë‹¤', color: '#FFD740', category: 'ê¸°ì¨' },
            { name: 'ì¦ê²ë‹¤', emoji: 'ğŸ˜„', desc: 'ë§ˆìŒì— ê±°ìŠ¬ë¦¼ì´ ì—†ì´ íë­‡í•˜ê³  ê¸°ë¶„ì´ ì¢‹ë‹¤', color: '#FFEE58', category: 'ê¸°ì¨' },
            { name: 'ìœ ì¾Œí•˜ë‹¤', emoji: 'ğŸ˜†', desc: 'ì¦ê²ê³  ìƒì¾Œí•˜ë‹¤', color: '#FFF59D', category: 'ê¸°ì¨' },
            { name: 'ìƒì¾Œí•˜ë‹¤', emoji: 'ğŸŒŸ', desc: 'ê¸°ë¶„ì´ ì‹œì›í•˜ê³  ì‚°ëœ»í•˜ë‹¤', color: '#FFEB3B', category: 'ê¸°ì¨' },
            { name: 'ì‚°ëœ»í•˜ë‹¤', emoji: 'âœ¨', desc: 'ê¸°ë¶„ì´ë‚˜ ëŠë‚Œì´ ê¹¨ë—í•˜ê³  ì‹œì›ìŠ¤ëŸ½ë‹¤', color: '#FFF9C4', category: 'ê¸°ì¨' },
            { name: 'íë­‡í•˜ë‹¤', emoji: 'â˜ºï¸', desc: 'ë§ˆìŒì— ë“¤ì–´ ë§¤ìš° ë§Œì¡±ìŠ¤ëŸ½ë‹¤', color: '#FFE082', category: 'ê¸°ì¨' },
            { name: 'í†µì¾Œí•˜ë‹¤', emoji: 'ğŸ‰', desc: 'ì•„ì£¼ ì¦ê²ê³  ì‹œì›í•˜ì—¬ ìœ ì¾Œí•˜ë‹¤', color: '#FFCA28', category: 'ê¸°ì¨' },
            { name: 'ìë‘ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜¤', desc: 'ë‚¨ì—ê²Œ ë“œëŸ¬ë‚´ì–´ ë½ë‚¼ ë§Œí•œ ë°ê°€ ìˆë‹¤', color: '#FFD54F', category: 'ê¸°ì¨' },
            
            // ìŠ¬í”” ê´€ë ¨ (11ê°œ)
            { name: 'ìŠ¬í”„ë‹¤', emoji: 'ğŸ˜¢', desc: 'ì„œëŸ¬ìš´ ì¼ì„ ê²ªê±°ë‚˜ ë¶ˆìŒí•œ ì¼ì„ ë³´ê³  ìš¸ê³  ì‹¶ì„ ë§Œí¼ ë§ˆìŒì´ ì•„í”„ê³  ê´´ë¡­ë‹¤', color: '#90CAF9', category: 'ìŠ¬í””' },
            { name: 'ì™¸ë¡­ë‹¤', emoji: 'ğŸ˜', desc: 'í˜¼ì ìˆê±°ë‚˜ ê¸°ëŒˆ ê³³ì´ ì—†ì–´ í—ˆì „í•˜ê³  ì“¸ì“¸í•˜ë‹¤', color: '#81C784', category: 'ìŠ¬í””' },
            { name: 'ì„œëŸ½ë‹¤', emoji: 'ğŸ˜­', desc: 'ë‹µë‹µí•˜ê³  ìŠ¬í”„ë‹¤', color: '#64B5F6', category: 'ìŠ¬í””' },
            { name: 'ê·¸ë¦½ë‹¤', emoji: 'ğŸ¥º', desc: 'ë³´ê³  ì‹¶ê±°ë‚˜ ë§Œë‚˜ê³  ì‹¶ë‹¤. ì—†ì–´ì„œ í•„ìš”í•˜ê³  ì•„ì‰½ë‹¤', color: '#7986CB', category: 'ìŠ¬í””' },
            { name: 'ì“¸ì“¸í•˜ë‹¤', emoji: 'ğŸ˜”', desc: 'ë§ˆìŒì´ ì™¸ë¡­ê³  ìŠ¬í”„ë‹¤', color: '#5C6BC0', category: 'ìŠ¬í””' },
            { name: 'ìš°ìš¸í•˜ë‹¤', emoji: 'ğŸ˜Ÿ', desc: 'ê±±ì •ë˜ê±°ë‚˜ ë‹µë‹µí•˜ì—¬ í™œê¸°ê°€ ì—†ë‹¤', color: '#3F51B5', category: 'ìŠ¬í””' },
            { name: 'ìš¸ì í•˜ë‹¤', emoji: 'â˜ï¸', desc: 'ë§ˆìŒì´ ì“¸ì“¸í•˜ê³  ë‹µë‹µí•˜ë‹¤', color: '#3949AB', category: 'ìŠ¬í””' },
            { name: 'í—ˆë¬´í•˜ë‹¤', emoji: 'ğŸ’­', desc: 'ì•„ë¬´ ì˜ë¯¸ë‚˜ ë³´ëŒì´ ì—†ì´ í—ˆì „í•˜ê³  ì“¸ì“¸í•˜ë‹¤', color: '#303F9F', category: 'ìŠ¬í””' },
            { name: 'í—ˆì „í•˜ë‹¤', emoji: 'ğŸ•³ï¸', desc: 'ë¬´ì—‡ì„ ìƒê±°ë‚˜ ì˜ì§€í•  ê³³ì´ ì—†ì–´ì§„ ê²ƒê°™ì´ ì„œìš´í•œ ëŠë‚Œì´ ìˆë‹¤', color: '#283593', category: 'ìŠ¬í””' },
            { name: 'ì•„í”„ë‹¤', emoji: 'ğŸ’”', desc: 'ë§ˆìŒì´ í¸í•˜ì§€ ì•Šê³  ê´´ë¡­ë‹¤', color: '#1A237E', category: 'ìŠ¬í””' },
            { name: 'ì†ìƒí•˜ë‹¤', emoji: 'ğŸ˜£', desc: 'ê±±ì •ìŠ¤ëŸ½ê±°ë‚˜ í™”ë‚˜ëŠ” ì¼ë¡œ ë§ˆìŒì´ í¸í•˜ì§€ ì•Šê³  ê´´ë¡­ë‹¤', color: '#4527A0', category: 'ìŠ¬í””' },
            
            // í™”ë‚¨ ê´€ë ¨ (7ê°œ)
            { name: 'í™”ë‚˜ë‹¤', emoji: 'ğŸ˜¡', desc: 'ë§ˆìŒì— ë“¤ì§€ ì•Šê±°ë‚˜ ê¸°ë¶„ì´ ë‚˜ë¹ ì„œ ë¶ˆì¾Œí•˜ê³  ë‹µë‹µí•œ ë§ˆìŒì´ ìƒê¸°ë‹¤', color: '#EF5350', category: 'í™”ë‚¨' },
            { name: 'ì§œì¦ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜¤', desc: 'ë³´ê¸°ì— ëª»ë§ˆë•…í•œ ë°ê°€ ìˆë‹¤', color: '#E53935', category: 'í™”ë‚¨' },
            { name: 'ì–µìš¸í•˜ë‹¤', emoji: 'ğŸ˜ ', desc: 'ì•„ë¬´ ì˜ëª» ì—†ì´ í˜¼ë‚˜ê±°ë‚˜ ë²Œì„ ë°›ì•„ì„œ ì†ì´ ìƒí•˜ê³  ë¶„í•˜ë‹¤', color: '#D32F2F', category: 'í™”ë‚¨' },
            { name: 'ë°‰ë‹¤', emoji: 'ğŸ˜’', desc: 'ë§ˆìŒì— ë“¤ì§€ ì•Šê±°ë‚˜ ëˆˆì— ê±°ìŠ¬ë¦¬ëŠ” ëŠë‚Œì´ ìˆë‹¤', color: '#C62828', category: 'í™”ë‚¨' },
            { name: 'ì›ë§ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜‘', desc: 'ëª»ë§ˆë•…í•˜ê²Œ ì—¬ê²¨ íƒ“í•˜ê±°ë‚˜ ë¶ˆë§Œì„ ê°€ì§€ê³  ë¯¸ì›Œí•˜ë‹¤', color: '#B71C1C', category: 'í™”ë‚¨' },
            { name: 'ë¶ˆì¾Œí•˜ë‹¤', emoji: 'ğŸ˜£', desc: 'ëª»ë§ˆë•…í•˜ì—¬ ê¸°ë¶„ì´ ì¢‹ì§€ ì•Šë‹¤', color: '#FF5722', category: 'í™”ë‚¨' },
            { name: 'ë‹µë‹µí•˜ë‹¤', emoji: 'ğŸ˜©', desc: 'ì¼ì´ ì˜ë˜ì§€ ì•Šì•„ì„œ ì• ê°€ íƒ€ë‹¤. ë¹„ì¢ê±°ë‚˜ ê½‰ ë§‰íŒ ëŠë‚Œì´ ìˆì–´ ë§ˆìŒì— ì—¬ìœ ê°€ ì—†ë‹¤', color: '#FF6347', category: 'í™”ë‚¨' },
            
            // ë¶ˆì•ˆ/ë‘ë ¤ì›€ ê´€ë ¨ (6ê°œ)
            { name: 'ë¶ˆì•ˆí•˜ë‹¤', emoji: 'ğŸ˜°', desc: 'ê±±ì •ì´ ë˜ì–´ ë§ˆìŒì´ í¸í•˜ì§€ ì•Šë‹¤', color: '#CE93D8', category: 'ë¶ˆì•ˆ' },
            { name: 'ê±±ì •ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜Ÿ', desc: 'ê±±ì •ì´ ë˜ì–´ í¸í•˜ì§€ ì•Šë‹¤', color: '#BA68C8', category: 'ë¶ˆì•ˆ' },
            { name: 'ë¬´ì„­ë‹¤', emoji: 'ğŸ˜¨', desc: 'ê±±ì •í•˜ëŠ” ì¼ì´ ë²Œì–´ì§ˆê¹Œ ë¶ˆì•ˆí•˜ë‹¤. ìœ„í—˜ì´ë‚˜ ìœ„í˜‘ìœ¼ë¡œ ëŠê»´ì ¸ ë§ˆìŒì´ ë¶ˆì•ˆí•˜ë‹¤', color: '#AB47BC', category: 'ë¶ˆì•ˆ' },
            { name: 'ë‘ë µë‹¤', emoji: 'ğŸ˜±', desc: 'ì–´ë–¤ ëŒ€ìƒì„ ë¬´ì„œì›Œí•˜ë©° ê±±ì •ì´ ë˜ì–´ ë¶ˆì•ˆí•˜ë‹¤', color: '#9C27B0', category: 'ë¶ˆì•ˆ' },
            { name: 'ì´ˆì¡°í•˜ë‹¤', emoji: 'ğŸ˜¬', desc: 'ì• ê°€ íƒ€ì„œ ë§ˆìŒì´ ì¡°ë§ˆì¡°ë§ˆí•˜ë‹¤', color: '#8E24AA', category: 'ë¶ˆì•ˆ' },
            { name: 'ì¡°ë§ˆì¡°ë§ˆí•˜ë‹¤', emoji: 'ğŸ˜Ÿ', desc: 'ì•ìœ¼ë¡œ ë‹¥ì¹  ì¼ì´ ê±±ì •ë˜ì–´ ë§ˆìŒì„ ë†“ì„ ìˆ˜ ì—†ê³  ë¶ˆì•ˆí•˜ë‹¤', color: '#7B1FA2', category: 'ë¶ˆì•ˆ' },
            
            // ë†€ëŒ ê´€ë ¨ (5ê°œ)
            { name: 'ë†€ë¼ë‹¤', emoji: 'ğŸ˜²', desc: 'ëœ»ë°–ì˜ ì¼ì´ë‚˜ ë¬´ì„œì›€ì— ê°€ìŠ´ì´ ë‘ê·¼ê±°ë¦¬ë‹¤. ì‹ ê¸°í•œ ê²ƒì„ ë³´ê³  ë§¤ìš° ê°ë™í•˜ë‹¤', color: '#FF9800', category: 'ë†€ëŒ' },
            { name: 'ë‹¹í™©ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜³', desc: 'ë†€ë¼ê±°ë‚˜ ë‹¤ê¸‰í•˜ì—¬ ì–´ë–»ê²Œ í•´ì•¼ í• ì§€ ëª¨ë¥´ë‹¤', color: '#FB8C00', category: 'ë†€ëŒ' },
            { name: 'ì–´ì´ì—†ë‹¤', emoji: 'ğŸ˜®', desc: 'ë„ˆë¬´ ì—„ì²­ë‚˜ê±°ë‚˜ ëœ»ë°–ì˜ ì¼ì„ ë‹¹í•´ì„œ ê¸°ê°€ ë§‰íˆë‹¤', color: '#F57C00', category: 'ë†€ëŒ' },
            { name: 'ì–¼ë–¨ë–¨í•˜ë‹¤', emoji: 'ğŸ˜µ', desc: 'ëœ»ë°–ì˜ ì¼ë¡œ ë‹¹í™©í•˜ì—¬ ì •ì‹ ì´ ì—†ê³  ë©í•˜ë‹¤', color: '#EF6C00', category: 'ë†€ëŒ' },
            { name: 'ì‹ ê¸°í•˜ë‹¤', emoji: 'ğŸ¤¯', desc: 'ë¯¿ì„ ìˆ˜ ì—†ì„ ì •ë„ë¡œ ë†€ëê³  ì´ìƒí•˜ë‹¤', color: '#E65100', category: 'ë†€ëŒ' },
            
            // ë¶€ë„ëŸ¬ì›€ ê´€ë ¨ (3ê°œ)
            { name: 'ë¶€ë„ëŸ½ë‹¤', emoji: 'ğŸ˜³', desc: 'ì˜ëª»ì„ ì €ì§ˆëŸ¬ì„œ ì°½í”¼í•˜ë‹¤. ìš©ê¸°ê°€ ì—†ì–´ ìˆ˜ì¤ë‹¤', color: '#FFCDD2', category: 'ë¶€ë„ëŸ¬ì›€' },
            { name: 'ì°½í”¼í•˜ë‹¤', emoji: 'ğŸ«£', desc: 'ë–³ë–³í•˜ì§€ ëª»í•œ ì¼ë¡œ ëª¹ì‹œ ë¶€ë„ëŸ½ë‹¤', color: '#EF9A9A', category: 'ë¶€ë„ëŸ¬ì›€' },
            { name: 'ë¯¸ì•ˆí•˜ë‹¤', emoji: 'ğŸ˜…', desc: 'ë‹¤ë¥¸ ì‚¬ëŒì— ëŒ€í•´ ë§ˆìŒì´ í¸í•˜ì§€ ì•Šê³  ë¶€ë„ëŸ½ë‹¤', color: '#E57373', category: 'ë¶€ë„ëŸ¬ì›€' },
            
            // ê°ì‚¬ ê´€ë ¨ (2ê°œ)
            { name: 'ê³ ë§™ë‹¤', emoji: 'ğŸ™', desc: 'ë‚¨ì´ ì¹œì ˆí•˜ê²Œ ëŒ€í•´ ì£¼ê±°ë‚˜ ë„ì›€ì„ ì£¼ì–´ì„œ íë­‡í•˜ê³  ì¦ê²ë‹¤', color: '#A5D6A7', category: 'ê°ì‚¬' },
            { name: 'ë‹¤í–‰ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜Œ', desc: 'ìƒê°ë³´ë‹¤ ì¼ì´ ì˜ë˜ì–´ ìš´ì´ ì¢‹ì€ ë“¯í•˜ë‹¤. ë§ˆìŒì´ ë†“ì´ê³  í¡ì¡±í•˜ë‹¤', color: '#81C784', category: 'ê°ì‚¬' },
            
            // ê¸°íƒ€ ê°ì • (16ê°œ)
            { name: 'ê´´ë¡­ë‹¤', emoji: 'ğŸ˜–', desc: 'ì•„í”„ê³  í˜ë“¤ë‹¤. ëª¸ì´ë‚˜ ë§ˆìŒì´ í¸í•˜ì§€ ì•Šê³  ê³ í†µìŠ¤ëŸ½ë‹¤', color: '#BCAAA4', category: 'ê¸°íƒ€' },
            { name: 'ê¶ê¸ˆí•˜ë‹¤', emoji: 'ğŸ¤”', desc: 'ëª¨ë¥´ëŠ” ê²ƒì„ ì•Œê³  ì‹¶ì–´ ëª¹ì‹œ ë‹µë‹µí•˜ë‹¤', color: '#FFB74D', category: 'ê¸°íƒ€' },
            { name: 'ë‚˜ì˜ë‹¤', emoji: 'ğŸ˜•', desc: 'ë§ˆìŒì´ë‚˜ ê¸°ë¶„ì´ ì¢‹ì§€ ì•Šë‹¤', color: '#A1887F', category: 'ê¸°íƒ€' },
            { name: 'ê´œì°®ë‹¤', emoji: 'ğŸ˜', desc: 'ê±±ì •ì´ ë˜ê±°ë‚˜ ë¬¸ì œê°€ ë  ê²ƒì´ ì—†ë‹¤. ë‚˜ì˜ì§€ ì•Šê³  ë³´í†µ ì´ìƒìœ¼ë¡œ ì¢‹ë‹¤', color: '#E0E0E0', category: 'ê¸°íƒ€' },
            { name: 'ë”°ë¶„í•˜ë‹¤', emoji: 'ğŸ˜‘', desc: 'ì¬ë¯¸ê°€ ì—†ì–´ ì§€ë£¨í•˜ê³  ì‹¬ì‹¬í•˜ë‹¤', color: '#BDBDBD', category: 'ê¸°íƒ€' },
            { name: 'ë¬´ê²ë‹¤', emoji: 'ğŸ˜', desc: 'ë§ˆìŒì´ ìœ ì¾Œí•˜ì§€ ì•Šê³  í™œë°œí•œ ê¸°ìš´ì´ ì—†ë‹¤', color: '#9E9E9E', category: 'ê¸°íƒ€' },
            { name: 'ë¶€ë‹´ìŠ¤ëŸ½ë‹¤', emoji: 'ğŸ˜“', desc: 'ì–´ë–¤ ì¼ì´ ì§ì²˜ëŸ¼ ëŠê»´ì§€ê³  ë¶ˆí¸í•˜ë‹¤', color: '#757575', category: 'ê¸°íƒ€' },
            { name: 'ë¶ˆìŒí•˜ë‹¤', emoji: 'ğŸ˜¢', desc: 'ë‚¨ì˜ ì²˜ì§€ê°€ ë”±í•´ì„œ ê°€ìŠ´ ì•„í”„ë‹¤', color: '#616161', category: 'ê¸°íƒ€' },
            { name: 'ë¶ˆí¸í•˜ë‹¤', emoji: 'ğŸ˜', desc: 'ë§ˆìŒì´ í¸í•˜ì§€ ì•Šê³  ê´´ë¡­ë‹¤', color: '#424242', category: 'ê¸°íƒ€' },
            { name: 'ë¶ˆí–‰í•˜ë‹¤', emoji: 'ğŸ˜”', desc: 'ì¢‹ì§€ ì•Šì€ ì¼ë¡œ ì¸í•´ ê´´ë¡­ê±°ë‚˜ ìŠ¬í”„ë‹¤. í–‰ë³µí•˜ì§€ ëª»í•˜ë‹¤', color: '#212121', category: 'ê¸°íƒ€' },
            { name: 'ì•ˆì“°ëŸ½ë‹¤', emoji: 'ğŸ˜¥', desc: 'ê°€ì—¾ê³  ë¶ˆìŒí•˜ë‹¤', color: '#78909C', category: 'ê¸°íƒ€' },
            { name: 'ì•ˆíƒ€ê¹ë‹¤', emoji: 'ğŸ˜Ÿ', desc: 'ë§ˆìŒëŒ€ë¡œ ë˜ì§€ ì•Šê±°ë‚˜ ë³´ê¸°ì— ë”±í•˜ì—¬ ê°€ìŠ´ ì•„í”„ê³  ë‹µë‹µí•˜ë‹¤', color: '#607D8B', category: 'ê¸°íƒ€' },
            { name: 'ì¢‹ë‹¤', emoji: 'ğŸ˜Š', desc: 'ê¸°ì˜ê³  ë§Œì¡±ìŠ¤ëŸ½ë‹¤', color: '#8BC34A', category: 'ê¸°íƒ€' },
            { name: 'ì°ì°í•˜ë‹¤', emoji: 'ğŸ˜•', desc: 'ë§Œì¡±ìŠ¤ëŸ½ì§€ ëª»í•˜ê±°ë‚˜ ê±±ì •ìŠ¤ëŸ¬ìš´ ì¼ë¡œ ë§ˆìŒì— ê±¸ë¦¬ëŠ” ë°ê°€ ìˆë‹¤', color: '#546E7A', category: 'ê¸°íƒ€' },
            { name: 'í¸ì•ˆí•˜ë‹¤', emoji: 'ğŸ˜Œ', desc: 'ëª¸ê³¼ ë§ˆìŒì´ í˜ë“¤ì§€ ì•Šê³  ì¢‹ë‹¤. ê±±ì •ì´ ì—†ì–´ ì¢‹ë‹¤', color: '#B0BEC5', category: 'ê¸°íƒ€' },
            { name: 'í›„ë ¨í•˜ë‹¤', emoji: 'ğŸ˜¤', desc: 'ë‹µë‹µí•œ ê²ƒì´ í’€ë ¤ì„œ ë§ˆìŒì´ ì‹œì›í•˜ë‹¤', color: '#CFD8DC', category: 'ê¸°íƒ€' }
        ];
        
        // í˜„ì¬ í‘œì‹œë˜ëŠ” ê°ì • ëª©ë¡
        let currentEmotions = emotions;
        let currentCategory = 'all';
        let currentDictCategory = 'all';

        // ì „ì—­ ë³€ìˆ˜ë“¤
        let canvas, ctx;
        let isDrawing = false;
        let currentTool = 'pen';
        let currentColor = '#000000';
        let currentSize = 5;
        let selectedEmotion = null;
        let selectedTags = {
            time: null,
            place: null
        };
        let drawHistory = [];
        let historyStep = -1;
        let sessionGallery = [];

        // ìƒ‰ìƒ íŒ”ë ˆíŠ¸
        const colors = [
            '#000000', '#FFFFFF', '#FF0000', '#FF7F00', '#FFFF00', '#00FF00',
            '#0000FF', '#4B0082', '#9400D3', '#FF1493', '#FFB6C1', '#87CEEB'
        ];

        // ì´ˆê¸°í™” í•¨ìˆ˜
        document.addEventListener('DOMContentLoaded', function() {
            // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ í™•ì¸
            if (typeof window.jspdf === 'undefined') {
                console.warn('jsPDF ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. PDF ê¸°ëŠ¥ì´ ì œí•œë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }
            if (typeof html2canvas === 'undefined') {
                console.warn('html2canvas ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
            }
            
            console.log('ì´ˆê¸°í™” ì‹œì‘ - ê°ì • ê°œìˆ˜:', emotions.length);
            initCanvas();
            createEmotionButtons();
            createColorPalette();
            loadGallery();
            createEmotionDictionary();
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
            document.getElementById('emotion-intensity').addEventListener('input', function(e) {
                document.getElementById('intensity-value').textContent = e.target.value;
            });
            
            document.getElementById('pen-size').addEventListener('input', function(e) {
                currentSize = e.target.value;
                document.getElementById('size-value').textContent = e.target.value;
            });
            
            window.addEventListener('beforeunload', function(e) {
                if (sessionGallery.length > 0) {
                    e.preventDefault();
                    e.returnValue = 'ì €ì¥í•˜ì§€ ì•Šì€ ì‘í’ˆì´ ìˆìŠµë‹ˆë‹¤. ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ?';
                }
            });
        });

        // ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì™„ë£Œ í™•ì¸
        window.addEventListener('load', function() {
            if (typeof window.jspdf === 'undefined') {
                console.error('PDF ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© ì‹¤íŒ¨');
            }
        });

        // ìº”ë²„ìŠ¤ ì´ˆê¸°í™”
        function initCanvas() {
            canvas = document.getElementById('drawingCanvas');
            ctx = canvas.getContext('2d');
            
            canvas.width = 600;
            canvas.height = 400;
            
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // í„°ì¹˜ ì´ë²¤íŠ¸
            canvas.addEventListener('touchstart', handleTouch, { passive: false });
            canvas.addEventListener('touchmove', handleTouch, { passive: false });
            canvas.addEventListener('touchend', handleTouchEnd, { passive: false });
            
            saveHistory();
        }

        // ìº”ë²„ìŠ¤ ì¢Œí‘œ ê³„ì‚° ê°œì„ 
        function getMousePos(canvas, e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            return {
                x: (e.clientX - rect.left) * scaleX,
                y: (e.clientY - rect.top) * scaleY
            };
        }

        // í„°ì¹˜ ì´ë²¤íŠ¸ ì²˜ë¦¬ ê°œì„ 
        function handleTouch(e) {
            e.preventDefault();
            if (!e.touches || !e.touches[0]) return;
            
            const touch = e.touches[0];
            const rect = canvas.getBoundingClientRect();
            
            if (e.type === 'touchstart') {
                const pos = getMousePos(canvas, touch);
                startDrawingAtPos(pos.x, pos.y);
            } else if (e.type === 'touchmove') {
                const pos = getMousePos(canvas, touch);
                drawAtPos(pos.x, pos.y);
            }
        }

        function handleTouchEnd(e) {
            e.preventDefault();
            stopDrawing();
        }

        // ê°ì • ë²„íŠ¼ ìƒì„±
        function createEmotionButtons() {
            const container = document.getElementById('emotion-selector');
            container.innerHTML = '';
            
            currentEmotions.forEach((emotion, index) => {
                const btn = document.createElement('button');
                btn.className = 'emotion-card p-1 bg-gradient-to-br from-white to-gray-50 rounded-lg shadow-md hover:shadow-lg text-center';
                btn.innerHTML = `
                    <div class="text-lg">${emotion.emoji}</div>
                    <div class="text-[10px] font-medium">${emotion.name}</div>
                `;
                btn.onclick = (e) => selectEmotion(emotion, e);
                btn.setAttribute('data-name', emotion.name);
                btn.setAttribute('data-category', emotion.category || 'ê¸°íƒ€');
                container.appendChild(btn);
            });
        }
        
        // ê°ì • ê²€ìƒ‰ ê¸°ëŠ¥
        window.searchEmotions = function() {
            const searchTerm = document.getElementById('emotion-search').value.toLowerCase();
            if (!searchTerm) {
                if (currentCategory === 'all') {
                    currentEmotions = emotions;
                } else {
                    currentEmotions = emotions.filter(e => e.category === currentCategory);
                }
            } else {
                currentEmotions = emotions.filter(e => 
                    e.name.toLowerCase().includes(searchTerm) || 
                    e.desc.toLowerCase().includes(searchTerm)
                );
            }
            createEmotionButtons();
        };
        
        // ì¹´í…Œê³ ë¦¬ í•„í„° ê¸°ëŠ¥
        window.filterCategory = function(category) {
            currentCategory = category;
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            if (category === 'all') {
                currentEmotions = emotions;
            } else {
                currentEmotions = emotions.filter(e => e.category === category);
            }
            
            // ê²€ìƒ‰ì–´ê°€ ìˆìœ¼ë©´ ê²€ìƒ‰ ê²°ê³¼ ë‚´ì—ì„œ í•„í„°ë§
            const searchTerm = document.getElementById('emotion-search').value.toLowerCase();
            if (searchTerm) {
                currentEmotions = currentEmotions.filter(e => 
                    e.name.toLowerCase().includes(searchTerm) || 
                    e.desc.toLowerCase().includes(searchTerm)
                );
            }
            
            createEmotionButtons();
        };
        
        // ê°ì • ì‚¬ì „ ì¹´í…Œê³ ë¦¬ í•„í„°
        window.filterDictionaryCategory = function(category) {
            currentDictCategory = category;
            document.querySelectorAll('.dict-category-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-purple-500', 'text-white');
                btn.classList.add('bg-gray-100');
            });
            event.target.classList.remove('bg-gray-100');
            event.target.classList.add('active', 'bg-purple-500', 'text-white');
            
            createEmotionDictionary();
        };

        // ìƒ‰ìƒ íŒ”ë ˆíŠ¸ ìƒì„±
        function createColorPalette() {
            const container = document.getElementById('color-palette');
            container.innerHTML = '';
            
            colors.forEach(color => {
                const btn = document.createElement('button');
                btn.className = 'color-btn w-8 h-8 rounded-full border-2 border-gray-300';
                btn.style.backgroundColor = color;
                btn.onclick = (e) => setColor(color, e);
                if (color === currentColor) {
                    btn.classList.add('active');
                }
                container.appendChild(btn);
            });
        }

        // ê°ì • ì„ íƒ
        function selectEmotion(emotion, event) {
            selectedEmotion = emotion;
            document.getElementById('selected-emotion-display').classList.remove('hidden');
            document.getElementById('selected-emotion-text').textContent = `${emotion.emoji} ${emotion.name}`;
            document.getElementById('selected-emotion-desc').textContent = emotion.desc;
            
            document.querySelectorAll('.emotion-card').forEach((card) => {
                card.classList.remove('selected');
            });
            if (event && event.target) {
                event.target.closest('.emotion-card').classList.add('selected');
            }
        }

        // ê¸€ë¡œë²Œ í•¨ìˆ˜ë“¤ - window ê°ì²´ì— ë“±ë¡
        window.toggleTag = function(event, category, value) {
            const button = event.target.closest('.tag-btn');
            
            if (selectedTags[category] === value) {
                selectedTags[category] = null;
                button.classList.remove('bg-purple-200');
                button.classList.add('bg-gray-100');
            } else {
                button.parentElement.querySelectorAll('.tag-btn').forEach(btn => {
                    btn.classList.remove('bg-purple-200');
                    btn.classList.add('bg-gray-100');
                });
                
                selectedTags[category] = value;
                button.classList.remove('bg-gray-100');
                button.classList.add('bg-purple-200');
            }
        };

        window.setTool = function(event, tool) {
            currentTool = tool;
            const button = event.target.closest('.tool-btn');
            
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-purple-500');
            });
            button.classList.add('ring-2', 'ring-purple-500');
            
            canvas.style.cursor = tool === 'eraser' ? 'grab' : 'crosshair';
        };

        // ìƒ‰ìƒ ì„¤ì • - window ê°ì²´ì— ë“±ë¡
        window.setColor = function(color, event) {
            currentColor = color;
            currentTool = 'pen';
            
            document.querySelectorAll('.color-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            canvas.style.cursor = 'crosshair';
        };

        // ê·¸ë¦¬ê¸° ì‹œì‘
        function startDrawing(e) {
            const pos = getMousePos(canvas, e);
            startDrawingAtPos(pos.x, pos.y);
        }

        function startDrawingAtPos(x, y) {
            isDrawing = true;
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineWidth = currentSize;
        }

        // ê·¸ë¦¬ê¸°
        function draw(e) {
            if (!isDrawing) return;
            const pos = getMousePos(canvas, e);
            drawAtPos(pos.x, pos.y);
        }

        function drawAtPos(x, y) {
            if (!isDrawing) return;
            
            if (currentTool === 'eraser') {
                ctx.globalCompositeOperation = 'destination-out';
                ctx.lineWidth = currentSize * 3;
            } else {
                ctx.globalCompositeOperation = 'source-over';
                ctx.strokeStyle = currentColor;
                ctx.lineWidth = currentSize;
            }
            
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        // ê·¸ë¦¬ê¸° ì¤‘ì§€
        function stopDrawing() {
            if (isDrawing) {
                isDrawing = false;
                ctx.beginPath();
                ctx.globalCompositeOperation = 'source-over';
                saveHistory();
            }
        }

        // ìº”ë²„ìŠ¤ ì§€ìš°ê¸°
        window.clearCanvas = function() {
            if (!confirm('ê·¸ë¦¼ì„ ëª¨ë‘ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            saveHistory();
        };

        // ì‹¤í–‰ ì·¨ì†Œ
        window.undo = function() {
            if (historyStep > 0) {
                historyStep--;
                const canvasPic = new Image();
                canvasPic.src = drawHistory[historyStep];
                canvasPic.onload = function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.drawImage(canvasPic, 0, 0);
                }
            }
        };

        // íˆìŠ¤í† ë¦¬ ì €ì¥
        function saveHistory() {
            historyStep++;
            if (historyStep < drawHistory.length) {
                drawHistory.length = historyStep;
            }
            drawHistory.push(canvas.toDataURL('image/jpeg', 0.8));
            
            if (drawHistory.length > 10) {
                drawHistory.shift();
                historyStep--;
            }
        }

        // ì´ë¯¸ì§€ ì—…ë¡œë“œ
        window.handleImageUpload = function(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    ctx.fillStyle = 'white';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    const scale = Math.min(canvas.width / img.width, canvas.height / img.height);
                    const x = (canvas.width - img.width * scale) / 2;
                    const y = (canvas.height - img.height * scale) / 2;
                    
                    ctx.drawImage(img, x, y, img.width * scale, img.height * scale);
                    saveHistory();
                }
                img.src = e.target.result;
            }
            reader.readAsDataURL(file);
            event.target.value = ''; // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™”
        };

        // ê°¤ëŸ¬ë¦¬ì— ì €ì¥
        window.saveToGallery = function() {
            if (!selectedEmotion) {
                alert('ë¨¼ì € ê°ì •ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            try {
                const card = {
                    id: Date.now(),
                    emotion: selectedEmotion.name,
                    emoji: selectedEmotion.emoji,
                    desc: selectedEmotion.desc,
                    image: canvas.toDataURL('image/jpeg', 0.9),
                    intensity: document.getElementById('emotion-intensity').value,
                    tags: { ...selectedTags },
                    situation: document.getElementById('situation-desc').value,
                    studentName: document.getElementById('student-name').value,
                    studentClass: document.getElementById('student-class').value,
                    date: new Date().toISOString()
                };
                
                sessionGallery.push(card);
                alert('ê°¤ëŸ¬ë¦¬ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
                loadGallery();
                resetForm();
            } catch (error) {
                console.error('ê°¤ëŸ¬ë¦¬ ì €ì¥ ì˜¤ë¥˜:', error);
                alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // í¼ ì´ˆê¸°í™”
        function resetForm() {
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            drawHistory = [];
            historyStep = -1;
            saveHistory();
            
            selectedEmotion = null;
            selectedTags = { time: null, place: null };
            document.getElementById('selected-emotion-display').classList.add('hidden');
            document.querySelectorAll('.emotion-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.querySelectorAll('.tag-btn').forEach(btn => {
                btn.classList.remove('bg-purple-200');
                btn.classList.add('bg-gray-100');
            });
            
            document.getElementById('emotion-intensity').value = 5;
            document.getElementById('intensity-value').textContent = '5';
            document.getElementById('situation-desc').value = '';
            document.getElementById('student-name').value = '';
            document.getElementById('student-class').value = '';
            document.getElementById('emotion-search').value = '';
        }

        // ì¹´ë“œ ìº”ë²„ìŠ¤ ìƒì„±
        function createCardCanvas() {
            const cardCanvas = document.createElement('canvas');
            cardCanvas.width = 800;
            cardCanvas.height = 600;
            const cardCtx = cardCanvas.getContext('2d');
            
            // ë°°ê²½
            cardCtx.fillStyle = '#f9fafb';
            cardCtx.fillRect(0, 0, cardCanvas.width, cardCanvas.height);
            
            // ì¹´ë“œ ë°°ê²½
            cardCtx.fillStyle = 'white';
            cardCtx.shadowColor = 'rgba(0, 0, 0, 0.1)';
            cardCtx.shadowBlur = 10;
            cardCtx.fillRect(20, 20, 760, 560);
            cardCtx.shadowBlur = 0;
            
            // ê·¸ë¦¼ ì˜ì—­
            const scale = Math.min(520 / canvas.width, 350 / canvas.height);
            const scaledWidth = canvas.width * scale;
            const scaledHeight = canvas.height * scale;
            const x = 40 + (520 - scaledWidth) / 2;
            const y = 40 + (350 - scaledHeight) / 2;
            
            cardCtx.strokeStyle = '#e5e7eb';
            cardCtx.lineWidth = 2;
            cardCtx.strokeRect(39, 39, 522, 352);
            cardCtx.drawImage(canvas, x, y, scaledWidth, scaledHeight);
            
            // ê°ì • ì •ë³´ ì˜ì—­
            cardCtx.fillStyle = '#f3f4f6';
            cardCtx.fillRect(40, 410, 520, 150);
            
            // í…ìŠ¤íŠ¸
            cardCtx.textAlign = 'left';
            cardCtx.fillStyle = '#1f2937';
            
            cardCtx.font = 'bold 36px sans-serif';
            cardCtx.fillText(`${selectedEmotion.emoji} ${selectedEmotion.name}`, 60, 460);
            
            cardCtx.font = '18px sans-serif';
            cardCtx.fillStyle = '#6b7280';
            cardCtx.fillText(selectedEmotion.desc, 60, 490);
            
            if (document.getElementById('emotion-intensity').value) {
                cardCtx.font = '16px sans-serif';
                cardCtx.fillStyle = '#9ca3af';
                const intensity = document.getElementById('emotion-intensity').value;
                cardCtx.fillText(`ê°ì • ê°•ë„: ${'â—'.repeat(intensity)}${'â—‹'.repeat(10-intensity)}`, 60, 520);
            }
            
            // ë‚ ì§œ
            cardCtx.textAlign = 'right';
            cardCtx.fillText(new Date().toLocaleDateString('ko-KR'), 540, 545);
            
            return cardCanvas;
        }

        // ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
        window.downloadAsImage = function() {
            if (!selectedEmotion) {
                alert('ë¨¼ì € ê°ì •ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            try {
                const cardCanvas = createCardCanvas();
                const link = document.createElement('a');
                const studentName = document.getElementById('student-name').value || 'í•™ìƒ';
                link.download = `ê°ì •ì¹´ë“œ_${selectedEmotion.name}_${studentName}_${Date.now()}.jpg`;
                link.href = cardCanvas.toDataURL('image/jpeg', 0.9);
                link.click();
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // PDF ë‹¤ìš´ë¡œë“œ
        window.downloadAsPDF = function() {
            if (!selectedEmotion) {
                alert('ë¨¼ì € ê°ì •ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            if (typeof window.jspdf === 'undefined') {
                alert('PDF ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();
                const cardCanvas = createCardCanvas();
                
                const imgData = cardCanvas.toDataURL('image/jpeg', 1.0);
                const imgWidth = 180;
                const imgHeight = (cardCanvas.height / cardCanvas.width) * imgWidth;
                
                pdf.addImage(imgData, 'JPEG', 15, 15, imgWidth, imgHeight);
                
                const studentName = document.getElementById('student-name').value || 'í•™ìƒ';
                pdf.save(`ê°ì •ì¹´ë“œ_${selectedEmotion.name}_${studentName}.pdf`);
            } catch (error) {
                console.error('PDF ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // ì¸ì‡„
        window.printCard = function() {
            if (!selectedEmotion) {
                alert('ë¨¼ì € ê°ì •ì„ ì„ íƒí•´ì£¼ì„¸ìš”!');
                return;
            }
            
            try {
                const cardCanvas = createCardCanvas();
                const printWindow = window.open('', '_blank');
                printWindow.document.write(`
                    <html>
                    <head>
                        <title>ê°ì •ì¹´ë“œ ì¸ì‡„</title>
                        <style>
                            @media print {
                                body { margin: 0; }
                                img { max-width: 100%; height: auto; }
                            }
                            body {
                                display: flex;
                                justify-content: center;
                                align-items: center;
                                min-height: 100vh;
                                margin: 0;
                                background: #f3f4f6;
                            }
                        </style>
                    </head>
                    <body>
                        <img src="${cardCanvas.toDataURL()}" />
                        <script>window.print(); setTimeout(() => window.close(), 500);<\/script>
                    </body>
                    </html>
                `);
            } catch (error) {
                console.error('ì¸ì‡„ ì˜¤ë¥˜:', error);
                alert('ì¸ì‡„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // ê°¤ëŸ¬ë¦¬ ë¡œë“œ
        function loadGallery() {
            const container = document.getElementById('gallery-grid');
            const emptyMsg = document.getElementById('empty-gallery');
            
            if (sessionGallery.length === 0) {
                container.style.display = 'none';
                emptyMsg.style.display = 'block';
            } else {
                container.style.display = 'grid';
                emptyMsg.style.display = 'none';
                
                container.innerHTML = '';
                sessionGallery.forEach((card, index) => {
                    const div = document.createElement('div');
                    div.className = 'gallery-card bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition cursor-pointer';
                    
                    let tagsHtml = '';
                    if (card.tags.time) tagsHtml += `<span class="tag-badge bg-yellow-100 text-yellow-700">${card.tags.time}</span>`;
                    if (card.tags.place) tagsHtml += `<span class="tag-badge bg-blue-100 text-blue-700">${card.tags.place}</span>`;
                    
                    div.innerHTML = `
                        <img src="${card.image}" class="w-full h-32 object-cover">
                        <div class="p-3">
                            <div class="text-lg font-bold mb-1">${card.emoji} ${card.emotion}</div>
                            ${card.studentName ? `<div class="text-sm text-gray-600">${card.studentClass || ''} ${card.studentName}</div>` : ''}
                            ${tagsHtml ? `<div class="mt-1">${tagsHtml}</div>` : ''}
                            <div class="mt-2 flex gap-2">
                                <button onclick="downloadGalleryCard(${index})" class="text-xs px-2 py-1 bg-green-500 text-white rounded hover:bg-green-600">
                                    ğŸ“¥ ë‹¤ìš´ë¡œë“œ
                                </button>
                                <button onclick="deleteGalleryCard(${index})" class="text-xs px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600">
                                    ğŸ—‘ï¸ ì‚­ì œ
                                </button>
                            </div>
                        </div>
                    `;
                    container.appendChild(div);
                });
            }
        }

        // ê°¤ëŸ¬ë¦¬ ì¹´ë“œ ë‹¤ìš´ë¡œë“œ
        window.downloadGalleryCard = function(index) {
            try {
                const card = sessionGallery[index];
                const link = document.createElement('a');
                link.download = `ê°ì •ì¹´ë“œ_${card.emotion}_${card.studentName || 'í•™ìƒ'}.jpg`;
                link.href = card.image;
                link.click();
            } catch (error) {
                console.error('ê°¤ëŸ¬ë¦¬ ì¹´ë“œ ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // ê°¤ëŸ¬ë¦¬ ì¹´ë“œ ì‚­ì œ
        window.deleteGalleryCard = function(index) {
            if (confirm('ì´ ì¹´ë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                sessionGallery.splice(index, 1);
                loadGallery();
            }
        };

        // ì „ì²´ PDF ë‹¤ìš´ë¡œë“œ
        window.downloadAllAsPDF = function() {
            if (sessionGallery.length === 0) {
                alert('ê°¤ëŸ¬ë¦¬ì— ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (typeof window.jspdf === 'undefined') {
                alert('PDF ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();
                
                for (let i = 0; i < sessionGallery.length; i++) {
                    const card = sessionGallery[i];
                    
                    if (i > 0) {
                        pdf.addPage();
                    }
                    
                    pdf.addImage(card.image, 'JPEG', 15, 30, 180, 120);
                    
                    pdf.setFontSize(12);
                    let yPos = 160;
                    
                    pdf.text(`ê°ì •: ${card.emotion}`, 15, yPos);
                    yPos += 10;
                    
                    if (card.studentName) {
                        pdf.text(`ì‘ì„±ì: ${card.studentClass || ''} ${card.studentName}`, 15, yPos);
                        yPos += 10;
                    }
                    
                    if (card.intensity) {
                        pdf.text(`ê°ì • ê°•ë„: ${card.intensity}/10`, 15, yPos);
                        yPos += 10;
                    }
                    
                    pdf.text(`ë‚ ì§œ: ${new Date(card.date).toLocaleDateString('ko-KR')}`, 15, yPos);
                }
                
                pdf.save(`ê°ì •ì¹´ë“œ_ëª¨ìŒ_${new Date().toLocaleDateString('ko-KR')}.pdf`);
            } catch (error) {
                console.error('ì „ì²´ PDF ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        };

        // ê°ì • ì‚¬ì „ ìƒì„±
        function createEmotionDictionary() {
            const container = document.getElementById('emotion-dictionary');
            container.innerHTML = '';
            
            // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ê·¸ë£¹í™”
            const categories = {};
            let displayEmotions = currentDictCategory === 'all' ? emotions : emotions.filter(e => e.category === currentDictCategory);
            
            displayEmotions.forEach(emotion => {
                const category = emotion.category || 'ê¸°íƒ€';
                if (!categories[category]) {
                    categories[category] = [];
                }
                categories[category].push(emotion);
            });
            
            // ì¹´í…Œê³ ë¦¬ë³„ ì„¹ì…˜ ìƒì„±
            Object.keys(categories).forEach(category => {
                const section = document.createElement('div');
                section.className = 'mb-8';
                
                // ì¹´í…Œê³ ë¦¬ ì œëª©
                const title = document.createElement('h3');
                title.className = 'text-lg font-bold mb-4 text-gray-700 sticky top-0 bg-white py-2';
                const categoryEmoji = {
                    'ê¸°ì¨': 'ğŸ˜Š', 'ìŠ¬í””': 'ğŸ˜¢', 'í™”ë‚¨': 'ğŸ˜¡', 
                    'ë¶ˆì•ˆ': 'ğŸ˜°', 'ë†€ëŒ': 'ğŸ˜²', 'ë¶€ë„ëŸ¬ì›€': 'ğŸ˜³',
                    'ê°ì‚¬': 'ğŸ™', 'ê¸°íƒ€': 'ğŸ’­'
                };
                title.innerHTML = `${categoryEmoji[category] || 'ğŸ’­'} ${category} (${categories[category].length}ê°œ)`;
                section.appendChild(title);
                
                // ê°ì • ì¹´ë“œë“¤
                const grid = document.createElement('div');
                grid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4';
                
                categories[category].forEach(emotion => {
                    const card = document.createElement('div');
                    card.className = 'bg-gradient-to-br from-white to-gray-50 rounded-xl p-4 shadow-lg hover:shadow-xl transition cursor-pointer hover:scale-105';
                    card.style.borderLeft = `5px solid ${emotion.color}`;
                    card.innerHTML = `
                        <div class="flex items-start gap-3">
                            <div class="text-2xl md:text-3xl">${emotion.emoji}</div>
                            <div class="flex-1">
                                <h4 class="text-base md:text-lg font-bold mb-1">${emotion.name}</h4>
                                <p class="text-sm text-gray-600">${emotion.desc}</p>
                            </div>
                        </div>
                    `;
                    
                    // ì¹´ë“œ í´ë¦­ ì‹œ ê°ì • ì„ íƒ
                    card.onclick = () => {
                        selectedEmotion = emotion;
                        alert(`'${emotion.name}' ê°ì •ì´ ì„ íƒë˜ì—ˆìŠµë‹ˆë‹¤.\nì¹´ë“œ ë§Œë“¤ê¸° íƒ­ìœ¼ë¡œ ì´ë™í•˜ì—¬ ê·¸ë¦¼ì„ ê·¸ë ¤ë³´ì„¸ìš”!`);
                        switchTab(null, 'create');
                        document.getElementById('selected-emotion-display').classList.remove('hidden');
                        document.getElementById('selected-emotion-text').textContent = `${emotion.emoji} ${emotion.name}`;
                        document.getElementById('selected-emotion-desc').textContent = emotion.desc;
                    };
                    
                    grid.appendChild(card);
                });
                
                section.appendChild(grid);
                container.appendChild(section);
            });
        }

        // íƒ­ ì „í™˜
        window.switchTab = function(event, tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) {
                event.target.closest('.tab-btn').classList.add('active');
            }
        };
    </script>
</body>
</html>